/* ============================================
   PHASE 1: TOUCH TARGET COMPLIANCE
   Mobile Developer Methodology - 48px Minimum
   ============================================ */

@media (max-width: 768px) {

    /* 1.1 Button Standardization - 48px minimum */
    button,
    a.btn,
    .btn,
    input[type="submit"],
    input[type="button"],
    input[type="reset"] {
        min-height: 48px !important;
        min-width: 48px !important;
        padding: 12px 20px !important;
        border-radius: 8px !important;
    }

    /* Icon-only buttons need proper padding */
    button:has(svg:only-child),
    button:has(i:only-child) {
        padding: 12px !important;
        width: 48px !important;
        height: 48px !important;
    }

    /* Small buttons upgrade */
    .btn-sm {
        min-height: 48px !important;
        padding: 12px 16px !important;
    }

    /* 1.2 Form Input Optimization */
    input[type="text"],
    input[type="email"],
    input[type="tel"],
    input[type="number"],
    input[type="password"],
    input[type="date"],
    input[type="time"],
    input[type="search"],
    select,
    textarea {
        min-height: 48px !important;
        font-size: 16px !important;
        /* Prevents iOS zoom */
        padding: 12px 16px !important;
        border-radius: 8px !important;
        line-height: 1.5 !important;
    }

    textarea {
        min-height: 96px !important;
        /* 2x for multi-line */
    }

    /* 1.3 Checkbox/Radio with Tap Area */
    input[type="checkbox"],
    input[type="radio"] {
        width: 24px !important;
        height: 24px !important;
        margin: 12px !important;
        /* Creates 48px tap area */
        cursor: pointer !important;
    }

    /* Label tap area */
    label:has(input[type="checkbox"]),
    label:has(input[type="radio"]) {
        display: flex !important;
        align-items: center !important;
        min-height: 48px !important;
        padding: 8px 12px !important;
        cursor: pointer !important;
        gap: 12px !important;
    }

    /* 1.4 Table Row Optimization */
    table tr {
        min-height: 56px !important;
    }

    table td,
    table th {
        padding: 16px 12px !important;
        vertical-align: middle !important;
    }

    /* Hide columns on mobile - max 3 visible */
    table th:nth-child(n+4),
    table td:nth-child(n+4) {
        display: none !important;
    }

    /* 1.5 Spacing Enforcement - 12px minimum */
    .space-y-1>*+* {
        margin-top: 12px !important;
    }

    .space-y-2>*+* {
        margin-top: 12px !important;
    }

    .space-y-3>*+* {
        margin-top: 16px !important;
    }

    .space-y-4>*+* {
        margin-top: 16px !important;
    }

    .space-x-2>*+* {
        margin-left: 12px !important;
    }

    .gap-1 {
        gap: 12px !important;
    }

    .gap-2 {
        gap: 12px !important;
    }

    .gap-3 {
        gap: 16px !important;
    }

    .gap-4 {
        gap: 16px !important;
    }

    /* ============================================
       PHASE 2: THUMB ZONE OPTIMIZATION
       Primary CTAs at Bottom
       ============================================ */

    /* 2.1 Sticky Bottom Action Bars */
    .modal-footer,
    .form-actions,
    .action-bar,
    [class*="footer"] {
        position: sticky !important;
        bottom: 0 !important;
        left: 0 !important;
        right: 0 !important;
        background: white !important;
        padding: 16px !important;
        border-top: 1px solid #e5e7eb !important;
        box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1) !important;
        z-index: 100 !important;
        margin: 0 -16px -16px -16px !important;
        /* Extend to edges */
    }

    /* Primary button in sticky bar */
    .action-bar .btn-primary,
    .modal-footer .btn-primary,
    .form-actions .btn-primary {
        width: 100% !important;
        min-height: 56px !important;
        font-size: 18px !important;
        font-weight: 700 !important;
        margin-bottom: 0 !important;
    }

    /* Secondary button in sticky bar */
    .action-bar .btn-secondary,
    .modal-footer .btn-secondary {
        width: 100% !important;
        min-height: 48px !important;
        margin-top: 8px !important;
    }

    /* 2.2 FAB Positioning */
    .fab,
    [class*="floating-action"] {
        position: fixed !important;
        bottom: 90px !important;
        /* Above bottom nav */
        right: 20px !important;
        width: 56px !important;
        height: 56px !important;
        border-radius: 50% !important;
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2) !important;
        z-index: 90 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
    }

    /* 2.3 Close Button Accessibility */
    .modal-close,
    .close,
    [aria-label="Close"],
    [aria-label="Fechar"] {
        min-width: 44px !important;
        min-height: 44px !important;
        padding: 10px !important;
        border-radius: 50% !important;
    }

    /* ============================================
       PHASE 3: VISUAL FEEDBACK SYSTEM
       Instant Response < 50ms
       ============================================ */

    /* 3.1 Tap Feedback - Instant */
    button:active,
    a.btn:active,
    .tappable:active,
    [role="button"]:active {
        transform: scale(0.97) !important;
        opacity: 0.8 !important;
        transition: all 50ms ease-out !important;
    }

    /* Prevent double-tap zoom on buttons */
    button,
    a.btn,
    .tappable {
        touch-action: manipulation !important;
    }

    /* 3.2 Ripple Effect (Material-style) */
    .ripple {
        position: relative !important;
        overflow: hidden !important;
    }

    .ripple::after {
        content: '' !important;
        position: absolute !important;
        top: 50% !important;
        left: 50% !important;
        width: 0 !important;
        height: 0 !important;
        border-radius: 50% !important;
        background: rgba(255, 255, 255, 0.5) !important;
        transform: translate(-50%, -50%) !important;
        transition: width 0.3s, height 0.3s !important;
        pointer-events: none !important;
    }

    .ripple:active::after {
        width: 200px !important;
        height: 200px !important;
    }

    /* 3.3 Skeleton Loading Screens */
    .skeleton {
        background: linear-gradient(90deg,
                #f0f0f0 25%,
                #e0e0e0 50%,
                #f0f0f0 75%) !important;
        background-size: 200% 100% !important;
        animation: skeleton-loading 1.5s infinite !important;
        border-radius: 4px !important;
        color: transparent !important;
    }

    @keyframes skeleton-loading {
        0% {
            background-position: 200% 0;
        }

        100% {
            background-position: -200% 0;
        }
    }

    /* Skeleton variants */
    .skeleton-text {
        height: 16px !important;
        margin-bottom: 8px !important;
    }

    .skeleton-title {
        height: 24px !important;
        width: 60% !important;
        margin-bottom: 12px !important;
    }

    .skeleton-avatar {
        width: 48px !important;
        height: 48px !important;
        border-radius: 50% !important;
    }

    .skeleton-button {
        height: 48px !important;
        width: 120px !important;
        border-radius: 8px !important;
    }

    /* 3.4 Loading Button States */
    button.loading,
    .btn.loading {
        pointer-events: none !important;
        opacity: 0.6 !important;
        position: relative !important;
    }

    button.loading::after,
    .btn.loading::after {
        content: '' !important;
        display: inline-block !important;
        width: 16px !important;
        height: 16px !important;
        border: 2px solid currentColor !important;
        border-right-color: transparent !important;
        border-radius: 50% !important;
        animation: spin 0.6s linear infinite !important;
        margin-left: 8px !important;
        vertical-align: middle !important;
    }

    @keyframes spin {
        to {
            transform: rotate(360deg);
        }
    }

    /* 3.5 Success/Error States */
    .success-flash {
        animation: success-pulse 0.5s ease-out !important;
    }

    @keyframes success-pulse {

        0%,
        100% {
            transform: scale(1);
            opacity: 1;
        }

        50% {
            transform: scale(1.05);
            opacity: 0.9;
        }
    }

    .error-shake {
        animation: error-shake 0.4s ease-out !important;
    }

    @keyframes error-shake {

        0%,
        100% {
            transform: translateX(0);
        }

        25% {
            transform: translateX(-10px);
        }

        75% {
            transform: translateX(10px);
        }
    }

    /* ============================================
       PHASE 4: COGNITIVE LOAD REDUCTION
       Progressive Disclosure
       ============================================ */

    /* 4.1 Collapsible Sections */
    .section-collapsed .section-content {
        display: none !important;
    }

    .section-header {
        display: flex !important;
        align-items: center !important;
        justify-content: space-between !important;
        padding: 16px !important;
        min-height: 56px !important;
        cursor: pointer !important;
        background: white !important;
        border-radius: 8px !important;
        margin-bottom: 8px !important;
        transition: background 0.2s !important;
    }

    .section-header:active {
        background: #f3f4f6 !important;
    }

    .section-header .chevron {
        transition: transform 0.3s !important;
    }

    .section-collapsed .section-header .chevron {
        transform: rotate(-90deg) !important;
    }

    /* 4.2 Multi-Step Forms */
    .form-step {
        display: none !important;
    }

    .form-step.active {
        display: block !important;
    }

    .form-progress {
        display: flex !important;
        gap: 8px !important;
        margin-bottom: 24px !important;
        padding: 16px !important;
        background: #f9fafb !important;
        border-radius: 8px !important;
    }

    .form-progress-step {
        flex: 1 !important;
        height: 4px !important;
        background: #e5e7eb !important;
        border-radius: 2px !important;
        transition: background 0.3s !important;
    }

    .form-progress-step.completed {
        background: #10b981 !important;
    }

    .form-progress-step.active {
        background: #3b82f6 !important;
    }

    /* 4.3 Smart Input Groups */
    .input-group {
        margin-bottom: 20px !important;
    }

    .input-group label {
        display: block !important;
        font-size: 14px !important;
        font-weight: 600 !important;
        color: #374151 !important;
        margin-bottom: 8px !important;
    }

    .input-group .helper-text {
        font-size: 12px !important;
        color: #6b7280 !important;
        margin-top: 4px !important;
    }

    /* ============================================
       PHASE 5: PERFORMANCE OPTIMIZATION
       60fps Smooth Scrolling
       ============================================ */

    /* 5.1 Hardware Acceleration */
    .will-change-transform {
        will-change: transform !important;
    }

    .will-change-opacity {
        will-change: opacity !important;
    }

    /* Optimize animations */
    * {
        -webkit-font-smoothing: antialiased !important;
        -moz-osx-font-smoothing: grayscale !important;
    }

    /* 5.2 Lazy Loading Placeholder */
    img[data-src] {
        background: #f0f0f0 !important;
        min-height: 100px !important;
    }

    img.lazy-loaded {
        animation: fade-in 0.3s !important;
    }

    @keyframes fade-in {
        from {
            opacity: 0;
        }

        to {
            opacity: 1;
        }
    }

    /* 5.3 Virtual Scroll Container */
    .virtual-scroll {
        position: relative !important;
        overflow-y: auto !important;
        -webkit-overflow-scrolling: touch !important;
    }

    .virtual-scroll-item {
        position: absolute !important;
        left: 0 !important;
        right: 0 !important;
    }

    /* ============================================
       MOBILE-SPECIFIC UTILITIES
       ============================================ */

    /* Prevent text selection on buttons */
    button,
    .btn {
        -webkit-user-select: none !important;
        user-select: none !important;
    }

    /* Prevent callout on long press */
    a,
    button,
    img {
        -webkit-touch-callout: none !important;
    }

    /* Smooth momentum scrolling */
    * {
        -webkit-overflow-scrolling: touch !important;
    }

    /* Prevent pull-to-refresh on main content */
    body {
        overscroll-behavior-y: contain !important;
    }

    /* Hide financial summary on mobile (saves vertical space) */
    .mobile-hide {
        display: none !important;
    }

    /* Ensure grid elements are visible on mobile */
    .mobile-show {
        display: grid !important;
    }

    /* Dashboard Quick Action Cards - Fully Responsive */
    .space-y-8>div:first-child button {
        height: auto !important;
        min-height: clamp(120px, 18vh, 160px) !important;
        max-height: 180px !important;
        padding: clamp(12px, 2vh, 20px) clamp(10px, 2vw, 16px) !important;
        display: flex !important;
        flex-direction: column !important;
        justify-content: space-between !important;
    }

    .space-y-8>div:first-child button span {
        display: block !important;
        opacity: 1 !important;
        visibility: visible !important;
        white-space: normal !important;
        word-wrap: break-word !important;
        overflow-wrap: break-word !important;
    }

    .space-y-8>div:first-child button div {
        display: flex !important;
        opacity: 1 !important;
        visibility: visible !important;
    }

    /* Ensure card text is readable */
    .space-y-8>div:first-child button .text-lg {
        font-size: 13px !important;
        line-height: 1.4 !important;
        white-space: normal !important;
        overflow-wrap: break-word !important;
        word-wrap: break-word !important;
        font-weight: 700 !important;
        letter-spacing: 0.3px !important;
    }

    /* Ensure uppercase text wraps */
    .space-y-8>div:first-child button .uppercase {
        text-transform: uppercase !important;
        white-space: normal !important;
        overflow-wrap: break-word !important;
    }

    /* Larger icons for better visual hierarchy */
    .space-y-8>div:first-child button .w-12 {
        width: 40px !important;
        height: 40px !important;
    }

    .space-y-8>div:first-child button .w-12 svg,
    .space-y-8>div:first-child button .w-12 i {
        width: 24px !important;
        height: 24px !important;
    }

    /* Better spacing between icon and text */
    .space-y-8>div:first-child button>div:first-child {
        margin-bottom: 12px !important;
    }

    /* Make status info more visible */
    .space-y-8>div:first-child button .text-\[10px\] {
        font-size: 11px !important;
        font-weight: 600 !important;
    }

    /* Color-coded card backgrounds for easy identification */
    .space-y-8>div:first-child .grid>button:nth-child(1) {
        background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%) !important;
        border-color: #3b82f6 !important;
    }

    .space-y-8>div:first-child .grid>button:nth-child(2) {
        background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%) !important;
        border-color: #a855f7 !important;
    }

    .space-y-8>div:first-child .grid>button:nth-child(3) {
        background: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%) !important;
        border-color: #f97316 !important;
    }

    .space-y-8>div:first-child .grid>button:nth-child(4) {
        background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%) !important;
        border-color: #10b981 !important;
    }

    /* Safe area insets for notched devices */
    @supports (padding: env(safe-area-inset-bottom)) {
        .mobile-bottom-nav {
            padding-bottom: env(safe-area-inset-bottom) !important;
        }

        .action-bar,
        .modal-footer {
            padding-bottom: calc(16px + env(safe-area-inset-bottom)) !important;
        }
    }
}